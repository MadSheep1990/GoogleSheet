<!DOCTYPE html>
<html>
    <head>
        <title>Send Data to Google Sheet</title>
    </head>
    <body>
        <form id="dataForm">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name"><br><br>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email"><br><br>
            <label for="message">Message:</label>
            <textarea id="message" name="message"></textarea><br><br>
            <input type="button" value="Submit" onclick="sendData()">
        </form>

        <script>
        function sendData() {
            var name = document.getElementById('name').value;
            var email = document.getElementById('email').value;
            var message = document.getElementById('message').value;

            var data = {
                name: name,
                email: email,
                message: message
            };

            var xhr = new XMLHttpRequest();
            var url = 'https://script.google.com/macros/s/AKfycbzGVF2Ko8gK7YjnuvIuQyWG4aYFjHSujUOn2KVcIjAs6ib_5NdaBcyhqQnPsRQqqLDUeQ/exec'; // เปลี่ยน URL เป็น Web App ของคุณ
            xhr.open('POST', url, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    var json = JSON.parse(xhr.responseText);
                    console.log(json.result);
                    alert("ส่งข้อมูลสำเร็จ!");
                }
            };
            xhr.send(JSON.stringify(data));
        }
        </script>
    </body>
</html>
